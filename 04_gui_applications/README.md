# ğŸ–¥ï¸ GUIåº”ç”¨ç¨‹åº

## é¡¹ç›®æ¦‚è¿°

æœ¬é¡¹ç›®ä¸ºè§†è§‰æµ‹é‡è£…ç½®è®¾è®¡çš„å›¾å½¢ç”¨æˆ·ç•Œé¢ï¼ŒåŸºäºPython Tkinteræ¡†æ¶å¼€å‘ï¼Œæä¾›ç›´è§‚çš„æ“ä½œç•Œé¢å’Œå®æ—¶æ•°æ®æ˜¾ç¤ºåŠŸèƒ½ã€‚

## ç•Œé¢è®¾è®¡

### ä¸»ç•Œé¢ç‰¹ç‚¹
- **ç°ä»£åŒ–UI**: æ·±è‰²ä¸»é¢˜ï¼Œç§‘æŠ€æ„Ÿè®¾è®¡
- **å®æ—¶æ˜¾ç¤º**: åŠ¨æ€æ›´æ–°æµ‹é‡æ•°æ®
- **ä¸€é”®æ“ä½œ**: ç®€åŒ–çš„æ“ä½œæµç¨‹
- **çŠ¶æ€æŒ‡ç¤º**: æ¸…æ™°çš„å·¥ä½œçŠ¶æ€æ˜¾ç¤º

### ç•Œé¢å¸ƒå±€
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         åŸºäºå•ç›®è§†è§‰çš„ç›®æ ‡ç‰©æµ‹é‡è£…ç½®        â”‚  
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ç›®æ ‡ç‰©    â”‚     D      â”‚      x        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  
â”‚    1      â”‚   [æ•°å€¼]    â”‚   [æ•°å€¼]      â”‚
â”‚    2      â”‚   [æ•°å€¼]    â”‚   [æ•°å€¼]      â”‚
â”‚    3      â”‚   [æ•°å€¼]    â”‚   [æ•°å€¼]      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚              [å¼€å§‹æµ‹é‡]                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## æ–‡ä»¶ç»“æ„

```
04_gui_applications/
â”œâ”€â”€ build/                    # ç¼–è¯‘è¾“å‡ºç›®å½•
â”‚   â”œâ”€â”€ gui.py               # ç”Ÿæˆçš„GUIä»£ç 
â”‚   â””â”€â”€ assets/              # å›¾åƒèµ„æº
â”‚       â””â”€â”€ frame0/
â”‚           â””â”€â”€ button_1.png # æŒ‰é’®å›¾æ ‡
â”œâ”€â”€ è·¯å¾„é—®é¢˜è§£å†³ç‰ˆæœ¬/         # ä¼˜åŒ–ç‰ˆæœ¬
â”‚   â””â”€â”€ Test.py              # ä¸»ç¨‹åºæ–‡ä»¶
â””â”€â”€ build.zip                # æ‰“åŒ…æ–‡ä»¶
```

## åŠŸèƒ½ç‰¹æ€§

### 1. æ•°æ®æ˜¾ç¤º
- **å®æ—¶æ›´æ–°**: æµ‹é‡æ•°æ®å®æ—¶åˆ·æ–°
- **å¤šç›®æ ‡æ”¯æŒ**: åŒæ—¶æ˜¾ç¤º3ä¸ªç›®æ ‡ç‰©æ•°æ®
- **æ ¼å¼åŒ–æ˜¾ç¤º**: æ•°å€¼ç²¾åº¦æ§åˆ¶å’Œå•ä½æ˜¾ç¤º

### 2. äº¤äº’æ§åˆ¶
- **ä¸€é”®å¯åŠ¨**: å•æŒ‰é’®å¯åŠ¨æµ‹é‡æµç¨‹
- **çŠ¶æ€åé¦ˆ**: æŒ‰é’®çŠ¶æ€å’Œé¢œè‰²å˜åŒ–
- **å¼‚å¸¸å¤„ç†**: é”™è¯¯ä¿¡æ¯æç¤º

### 3. ç•Œé¢è‡ªé€‚åº”
- **åˆ†è¾¨ç‡é€‚é…**: æ”¯æŒä¸åŒå±å¹•åˆ†è¾¨ç‡
- **ç»„ä»¶ç¼©æ”¾**: è‡ªåŠ¨è°ƒæ•´ç»„ä»¶å¤§å°
- **å­—ä½“ä¼˜åŒ–**: æ¸…æ™°çš„å­—ä½“æ˜¾ç¤º

## æŠ€æœ¯å®ç°

### æ ¸å¿ƒç±»ç»“æ„
```python
class TargetMeasurementGUI:
    def __init__(self):
        self.flag = 0           # æŒ‰é’®çŠ¶æ€æ ‡å¿—
        self.Done = "æ•°å€¼1"     # è·ç¦»æµ‹é‡å€¼1
        self.Dtwo = "æ•°å€¼2"     # è·ç¦»æµ‹é‡å€¼2  
        self.Dthree = "æ•°å€¼3"   # è·ç¦»æµ‹é‡å€¼3
        self.xone = "æ•°å€¼1"     # å°ºå¯¸æµ‹é‡å€¼1
        self.xtwo = "æ•°å€¼2"     # å°ºå¯¸æµ‹é‡å€¼2
        self.xthree = "æ•°å€¼3"   # å°ºå¯¸æµ‹é‡å€¼3
```

### ä¸»è¦æ–¹æ³•
```python
def create_gui(self):          # åˆ›å»ºGUIç•Œé¢
def button_clicked(self):      # æŒ‰é’®ç‚¹å‡»å¤„ç†
def update_text(self):         # æ›´æ–°æ–‡æœ¬æ˜¾ç¤º
def get_flag(self):           # è·å–æ“ä½œæ ‡å¿—
def reset_flag(self):         # é‡ç½®æ“ä½œæ ‡å¿—
```

## ä½¿ç”¨æ–¹æ³•

### 1. ç¯å¢ƒå‡†å¤‡
```bash
# å®‰è£…ä¾èµ–
pip install tkinter  # é€šå¸¸Pythonè‡ªå¸¦

# è¿è¡Œç¨‹åº
cd 04_gui_applications/è·¯å¾„é—®é¢˜è§£å†³ç‰ˆæœ¬
python Test.py
```

### 2. ç•Œé¢æ“ä½œ
```python
# åˆ›å»ºGUIå®ä¾‹
gui = TargetMeasurementGUI()

# åˆ›å»ºç•Œé¢
gui.create_gui()

# æ›´æ–°æ˜¾ç¤ºæ•°æ®
gui.update_all_texts(
    Done="12.5",    # è·ç¦»å€¼1
    Dtwo="15.2",    # è·ç¦»å€¼2
    Dthree="18.7",  # è·ç¦»å€¼3
    xone="5.2",     # å°ºå¯¸å€¼1
    xtwo="7.8",     # å°ºå¯¸å€¼2
    xthree="6.1"    # å°ºå¯¸å€¼3
)

# è¿è¡Œä¸»å¾ªç¯
gui.run()
```

### 3. ä¸æµ‹é‡ç³»ç»Ÿé›†æˆ
```python
# é›†æˆç¤ºä¾‹
from Test import TargetMeasurementGUI
from vision_measurement import VisionMeasurementSystem

# åˆå§‹åŒ–ç»„ä»¶
gui = TargetMeasurementGUI()
vms = VisionMeasurementSystem(camera_matrix, dist_coeffs, camera_height)

gui.create_gui()

while True:
    # æ£€æŸ¥æŒ‰é’®çŠ¶æ€
    if gui.get_flag():
        # æ‰§è¡Œæµ‹é‡
        D, x, shapes = vms.measure(image)
        
        # æ›´æ–°æ˜¾ç¤º
        gui.update_text("Done", f"{D:.1f}")
        gui.update_text("xone", f"{x:.1f}")
        
        # é‡ç½®æ ‡å¿—
        gui.reset_flag()
    
    # æ›´æ–°ç•Œé¢
    gui.window.update()
```

## ç•Œé¢é…ç½®

### é¢œè‰²ä¸»é¢˜
```python
colors = {
    "background": "#101824",    # æ·±è“ç°èƒŒæ™¯
    "primary": "#6E3BFF",      # ç´«è‰²ä¸»è‰²è°ƒ
    "secondary": "#4A28A9",    # æ·±ç´«è‰²
    "accent": "#341B7D",       # å¼ºè°ƒè‰²
    "dark": "#261568",         # æ·±è‰²
    "text": "#F3F3F3"          # æµ…è‰²æ–‡å­—
}
```

### å¸ƒå±€å‚æ•°
```python
layout = {
    "window_size": "1232x794",
    "title_font": ("Inter Bold", 40),
    "data_font": ("Inter", 36),
    "button_size": (116, 96),
    "table_rows": 4,
    "table_cols": 3
}
```

### å“åº”å¼è®¾è®¡
```python
def resize_components(self, scale_factor):
    """æ ¹æ®å±å¹•åˆ†è¾¨ç‡è°ƒæ•´ç»„ä»¶å¤§å°"""
    self.window.geometry(f"{int(1232*scale_factor)}x{int(794*scale_factor)}")
    # è°ƒæ•´å…¶ä»–ç»„ä»¶...
```

## é«˜çº§åŠŸèƒ½

### 1. æ•°æ®éªŒè¯
```python
def validate_data(self, value):
    """éªŒè¯è¾“å…¥æ•°æ®æ ¼å¼"""
    try:
        float_value = float(value)
        if 0 <= float_value <= 100:  # åˆç†èŒƒå›´æ£€æŸ¥
            return f"{float_value:.1f}"
        else:
            return "è¶…èŒƒå›´"
    except ValueError:
        return "æ— æ•ˆ"
```

### 2. å†å²è®°å½•
```python
class DataHistory:
    def __init__(self, max_size=100):
        self.history = []
        self.max_size = max_size
    
    def add_record(self, timestamp, data):
        self.history.append({
            'time': timestamp,
            'data': data
        })
        if len(self.history) > self.max_size:
            self.history.pop(0)
```

### 3. å¯¼å‡ºåŠŸèƒ½
```python
def export_data(self, filename="measurement_data.csv"):
    """å¯¼å‡ºæµ‹é‡æ•°æ®åˆ°CSVæ–‡ä»¶"""
    import csv
    with open(filename, 'w', newline='') as csvfile:
        writer = csv.writer(csvfile)
        writer.writerow(['æ—¶é—´', 'è·ç¦»1', 'è·ç¦»2', 'è·ç¦»3', 'å°ºå¯¸1', 'å°ºå¯¸2', 'å°ºå¯¸3'])
        for record in self.history:
            writer.writerow([record['time']] + record['data'])
```

## æ€§èƒ½ä¼˜åŒ–

### 1. ç•Œé¢å“åº”ä¼˜åŒ–
```python
def update_display_async(self, data):
    """å¼‚æ­¥æ›´æ–°æ˜¾ç¤ºï¼Œé¿å…ç•Œé¢å¡é¡¿"""
    import threading
    
    def update_worker():
        self.update_all_texts(**data)
    
    thread = threading.Thread(target=update_worker)
    thread.daemon = True
    thread.start()
```

### 2. å†…å­˜ç®¡ç†
```python
def cleanup_resources(self):
    """æ¸…ç†èµ„æºï¼Œé‡Šæ”¾å†…å­˜"""
    if hasattr(self, 'button_image_1'):
        del self.button_image_1
    
    if self.window:
        self.window.quit()
        self.window.destroy()
```

### 3. äº‹ä»¶å¤„ç†ä¼˜åŒ–
```python
def debounce_button_click(self, delay=0.5):
    """é˜²æŠ–å¤„ç†ï¼Œé¿å…é‡å¤ç‚¹å‡»"""
    import time
    current_time = time.time()
    if hasattr(self, 'last_click_time'):
        if current_time - self.last_click_time < delay:
            return False
    self.last_click_time = current_time
    return True
```

## æ‰©å±•å¼€å‘

### 1. æ·»åŠ æ–°çš„æ˜¾ç¤ºç»„ä»¶
```python
def add_status_bar(self):
    """æ·»åŠ çŠ¶æ€æ """
    status_frame = tk.Frame(self.window, bg="#101824")
    status_frame.pack(side=tk.BOTTOM, fill=tk.X)
    
    self.status_label = tk.Label(
        status_frame, 
        text="å°±ç»ª", 
        bg="#101824", 
        fg="#F3F3F3"
    )
    self.status_label.pack(side=tk.LEFT, padx=10)
```

### 2. æ·»åŠ é…ç½®ç•Œé¢
```python
def create_settings_window(self):
    """åˆ›å»ºè®¾ç½®çª—å£"""
    settings_window = tk.Toplevel(self.window)
    settings_window.title("è®¾ç½®")
    settings_window.geometry("400x300")
    
    # æ·»åŠ è®¾ç½®é¡¹...
```

### 3. å¤šè¯­è¨€æ”¯æŒ
```python
class LanguageManager:
    def __init__(self):
        self.languages = {
            'zh': {'title': 'åŸºäºå•ç›®è§†è§‰çš„ç›®æ ‡ç‰©æµ‹é‡è£…ç½®'},
            'en': {'title': 'Monocular Vision Target Measurement Device'}
        }
        self.current_lang = 'zh'
    
    def get_text(self, key):
        return self.languages[self.current_lang].get(key, key)
```

## æµ‹è¯•å’Œè°ƒè¯•

### 1. å•å…ƒæµ‹è¯•
```python
import unittest

class TestGUI(unittest.TestCase):
    def setUp(self):
        self.gui = TargetMeasurementGUI()
    
    def test_text_update(self):
        self.gui.update_text('Done', '12.5')
        self.assertEqual(self.gui.Done, '12.5')
    
    def test_flag_operations(self):
        self.gui.flag = 1
        self.assertEqual(self.gui.get_flag(), 1)
        self.gui.reset_flag()
        self.assertEqual(self.gui.flag, 0)
```

### 2. ç•Œé¢æµ‹è¯•
```python
def test_gui_creation():
    """æµ‹è¯•GUIåˆ›å»º"""
    gui = TargetMeasurementGUI()
    gui.create_gui()
    
    # æ£€æŸ¥ç»„ä»¶æ˜¯å¦æ­£ç¡®åˆ›å»º
    assert gui.window is not None
    assert gui.canvas is not None
    assert gui.button_1 is not None
```

## å¸¸è§é—®é¢˜

### 1. å›¾åƒèµ„æºåŠ è½½å¤±è´¥
**è§£å†³æ–¹æ¡ˆ**:
```python
def safe_load_image(self, image_path):
    """å®‰å…¨åŠ è½½å›¾åƒèµ„æº"""
    try:
        return PhotoImage(file=image_path)
    except tk.TclError:
        print(f"æ— æ³•åŠ è½½å›¾åƒ: {image_path}")
        return None
```

### 2. ç•Œé¢å†»ç»“
**åŸå› **: ä¸»çº¿ç¨‹ä¸­æ‰§è¡Œè€—æ—¶æ“ä½œ
**è§£å†³æ–¹æ¡ˆ**: ä½¿ç”¨å¤šçº¿ç¨‹æˆ–å¼‚æ­¥å¤„ç†

### 3. åˆ†è¾¨ç‡é€‚é…é—®é¢˜
**è§£å†³æ–¹æ¡ˆ**:
```python
def get_screen_scale(self):
    """è·å–å±å¹•ç¼©æ”¾æ¯”ä¾‹"""
    screen_width = self.window.winfo_screenwidth()
    screen_height = self.window.winfo_screenheight()
    
    # åŸºäº1920x1080è®¡ç®—ç¼©æ”¾æ¯”ä¾‹
    scale_x = screen_width / 1920
    scale_y = screen_height / 1080
    
    return min(scale_x, scale_y)
```

---
**æ³¨æ„**: GUIç•Œé¢è®¾è®¡åº”è€ƒè™‘ç”¨æˆ·ä½“éªŒï¼Œä¿æŒç®€æ´æ˜äº†çš„æ“ä½œæµç¨‹ã€‚
